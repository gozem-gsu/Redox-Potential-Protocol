# Workflow Summary: Opt-1 Folder Scripts

## Overview

The Opt-1 folder contains a series of scripts designed for the initial gas-phase optimizations and frequency calculations of molecules. These scripts operate on the coordinates prepared in the `xyzs` folder by the `1-retrieve-molecules.py` script.

## Script Descriptions

### 1. `2-opt-1.sh`

Executing the first round of optimization using coordinates from the xyzs folder, as generated by the "1-retrieve-molecules.py" script, involved using the UB3LYP/6-311++G(d,p) level of theory and basis set. Notably, this script facilitates both molecule optimization and frequency calculations. To handle encountered errors, such as "CPHF failed to converge in LinEq2" during frequency calculation, we involved supplementing the input file with the keyword Int=Acc2E=11 after encountering an error with a successful optimization but with frequency calculation issues. CPHF stands for Coupled Perturbed Hartree Fock and is a method for frequency calculation, it does not print the frequency until the very end of the calculation because this a matrix diagonalization calculation. It is either all frequencies converge at the same time and all get printed or the job crashes before and we do not see any frequency input. Usually frequency calculations are memory and disk space intensive because of the matrix diagonalization calculation method. Additionally, to address errors like "Optimization stopped. -- Number of steps exceeded, NStep= 266 -- Flag reset to prevent archiving" we often restarted the job with different initial geometries, often resolving optimization convergence issues. For molecules containing sulfonate groups, a charge adjustment was made. In our consideration, a charge of '0' denoted a neutral state, '-1' indicated a radical, and '-2' represented an anion for all non-sulfonate-containing molecules. Sulfonates, recognized as strong acids, are always deprotonated, with the number of negative charges equating the number of sulfonate groups present. Specifically, a single sulfonate group incurred charges of -1/-2/-3 for neutral/radical/anion states, respectively. In cases with two sulfonate groups, charges were set at -2/-3/-4 for neutral/radical/anion states, respectively. 

### 2. `3-rerun-failed-gaussian-jobs.py`

Ensures convergence success by aiming for Normal Termination in all log files. This script includes the addition of the "SCF=YQC" keyword to resolve convergence failures. This is primarily used when SCF convergence happens immediately in the first step and a change in the SCF algorithm helps reset the calculation. It was mainly encountered with anions.

### 3. `3.1-check-negative-frequencies.py`

This script identifies log files containing negative frequencies, which may indicate a local minimum or transition state rather than a true minimum. It helps minimize manual checks for convergence failure by pinpointing molecules with negative frequencies.

### 4. `check-termination.py`

This script checks log files for Normal Termination occurrences and identifies folders lacking log files or where log files did not indicate Normal Termination. It ensures that all calculations have been completed successfully.

### 5. `4-extract-coordinates.py`

Extracts coordinates of the last optimized geometry found under "Standard Orientation". Note that Gaussian log files differ based on the use of the 'nosym' keyword in the .com file. When symmetry is off, the optimized coordinates appear under "Standard Orientation". Conversely, with symmetry on, optimized coordinates are listed under "Input Orientation". Turning off symmetry allows the molecule more flexibility to achieve the lowest energy structure.

## Getting Started

To utilize these scripts:

1. Ensure that the `xyzs` folder contains the coordinates prepared by the `1-retrieve-molecules.py` script.
2. Execute the scripts in the order listed above, starting with `2-opt-1.sh`.
3. Monitor the output and log files for any errors or convergence issues, and make adjustments as necessary based on the guidelines provided.

## Contributions

Contributions and improvements to these scripts are welcome. Please feel free to submit pull requests or open issues with suggestions for enhancements.
